<div *ngIf="loading" class="loading-overlay">
  <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
    <span class="sr-only">Cargando...</span>
  </div>
</div>
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <div class="page-title-box d-sm-flex align-items-center justify-content-between">
        <h4 class="mb-sm-0">{{titulopant}}</h4>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-body">
          <div class="row ">
            <div class="col-xxl-1 col-md-6">
              <div>
                <label for="lic_numero" class="form-label">N° LIBRO</label>
                <input type="text" class="form-control form-control-sm" id="lic_numero" [(ngModel)]="lic_numero" disabled>
              </div>
            </div>
            <div class="col-xxl-1 col-md-6">
              <div>
                <label for="lic_fecha" class="form-label">FECHA</label>
                <input type="text" class="form-control form-control-sm" id="lic_fecha" [(ngModel)]="lic_fecha" disabled>
              </div>
            </div>
            <div class="col-xxl-5 col-md-6">
              <div>
                <label for="fed_nomcom" class="form-label">FEDATARIO</label>
                <input type="text" class="form-control form-control-sm" id="fed_nomcom" [(ngModel)]="fed_nomcom" disabled>
              </div>
            </div>
            <div class="col-xxl-2 col-md-6">
              <div>
                <label for="est_descri" class="form-label">ESTADO</label>
                <input type="text" class="form-control form-control-sm" id="est_descri" [(ngModel)]="est_descri" disabled>
              </div>
            </div>
            <div class="col-xxl-3 col-md-6">
              <div class="card-header align-items-center d-flex" style="justify-content: end; padding-right: 0px;">
                <div class="d-flex gap-2">
                  <button type="button" class="btn btn-primary btn-outline-primary btn-sm text-white d-flex justify-content-center align-items-center gap-1" id="btnNuevo" (click)="openModalNuevo()">
                    <i class="ri-add-box-line"></i> NUEVO </button>
                    <button *ngIf="btnPerm.excel" type="button" class="btn btn-success btn-sm text-white d-flex justify-content-center align-items-center gap-1" id="descargaExcel" (click)="descargaExcel()" [disabled]="!exportarHabilitado">
                    <i class="ri-file-excel-line"></i> EXPORTAR </button>
                  <button type="button" class="btn btn-danger btn-outline-danger btn-sm text-white d-flex justify-content-center align-items-center gap-1" id="btnRegresar" routerLink="/libro">
                    <i class="ri-arrow-go-back-line"></i> REGRESAR </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xl-12">
      <div class="card">
        <div class="card-body p-0">
          <div class="dt-mobile-scroll" id="tablaDataProceso">
            <table class="table align-middle table-nowrap mb-0 table--wide" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
              <thead>
                <tr style="text-align: center;">
                  <th scope="col" data-priority="1">N° LIBRO</th>
                  <th scope="col" data-priority="2">FECHA</th>
                  <th scope="col" data-priority="3">COPIAS</th>
                  <th scope="col" data-priority="4">TRÁMITE</th>
                  <th scope="col" data-priority="5">ADMINISTRADO</th>
                  <th scope="col" data-priority="6">N° EXPEDIENTE</th>
                  <th scope="col" data-priority="7">CONSTANCIA</th>
                  <th scope="col" data-priority="8">CUSTODIA</th>
                  <th scope="col" data-priority="9">ACCIONES</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of dataDetTramite" style="text-align: center;">
                  <td scope="row">
                    <p class="fw-bold">{{item.lid_numero}}</p>
                  </td>
                  <td>{{getFechaFormateada(item.lid_fecemi)}}</td>
                  <td>{{item.lid_numcop}}</td>
                  <td>{{item.lid_tramit}}</td>
                  <td>{{item.per_nombre}}</td>
                  <td>{{item.lid_numexp}}</td>
                  <td>
                    <button type="button" (click)="openModalConformidad(item)" class="btn btn-sm p-0 fs-20 btn-vertical-sm-hover" title="CONSTANCIA" id="vertical-hover"> 
                      <i class="ri-file-list-3-fill" style="color: #497c7e;"></i> 
                    </button>
                  </td>
                  <td>
                    <button type="button" (click)="openModalCustodia(item)" class="btn btn-sm p-0 fs-20 btn-vertical-sm-hover" title="CUSTODIA" id="vertical-hover"> 
                      <i class="ri-file-list-3-fill" style="color: #497c7e;"></i> 
                    </button>
                  </td>
                  <td>
                    <div class="dropdown">
                      <button type="button" class="btn btn-outline-primary btn-icon btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"><i class="ri-align-justify"></i></button>
                        <ul class="dropdown-menu dropdown-menu-end" [attr.data-bs-container]="'body'">
                          <li *ngIf="item.chk_botnue"><a class="dropdown-item edit-item-btn" (click)="$event.stopPropagation(); getIdButton(1, item)">NUEVO</a></li>
                          <li *ngIf="item.chk_botedt"><a class="dropdown-item edit-item-btn" (click)="$event.stopPropagation(); getIdButton(2, item)">EDITAR</a></li>
                          <li *ngIf="item.chk_botver"><a class="dropdown-item edit-item-btn" (click)="$event.stopPropagation(); getIdButton(3, item)">VER</a></li>
                          <li *ngIf="item.chk_botanu"><a class="dropdown-item edit-item-btn" (click)="$event.stopPropagation(); getIdButton(4, item)">ANULAR</a></li>
                        </ul>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>